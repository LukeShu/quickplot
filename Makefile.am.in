# If you add or remove any *.cpp or *.h files then
# `touch Makefile.am.in && rm quickplot && make'.

homepagefiles = @webimages@ @htmlfiles@\
 ChangeLog README README.devel\
 RELEASE_DATE TODO quickplot.ebuild

htmldir = $(datadir)/doc/quickplot/html
#nodist_html_DATA = help.html about.html index.html
html_DATA = help.html about.html index.html\
 quickplot_icon.png screenshot1_small.png\
 screenshot1.png screenshot2.png screenshot3.png\
 ChangeLog favicon.ico COPYING

bin_PROGRAMS = quickplot

quickplot_SOURCES = @quickplot_SOURCES@
BUILT_SOURCES = quickplot_icon.xpm about_browser16x16.xpm\
 newFrame16x16.xpm closeFrame16x16.xpm copyFrame16x16.xpm\
 saveImage16x16.xpm\
 File_readSndInt.cpp\
 File_readSndFloat.cpp\
 File_readSndDouble.cpp\
 help_html.cpp\
 about_html.cpp


quickplot_CXXFLAGS = -Wall $(GTKMM_CFLAGS) $(SNDFILE_CFLAGS)\
 -DHTMLDIR=\"$(htmldir)\"

#Why won't this work?
#launchBrowser_CXXFLAGS = -DHTMLDIR=\"$(htmldir)\"

quickplot_LDFLAGS = -Wall $(GTKMM_LIBS) $(SNDFILE_LIBS)
# -lefence

# require automake 1.7
AUTOMAKE_OPTIONS = 1.7


# Quickplot Icon
icondir      = $(datadir)/pixmaps
icon_DATA    = quickplot_icon.png


# We include everything that you could need for development.  We hate
# it when packages do not include all the needed files for
# development.


EXTRA_DIST = bootstrap mkconfigure_ac\
 cvsclean mkMakefile_am mkRELEASE_DATE\
 html2CString mkhtml mkversion install_portage\
 configure.ac.in CONFIG\
 TODO README.devel Makefile.am.in quickplot.ebuild\
 RELEASE_DATE\
 help.html.in about.html.in index.html.in\
 quickplot_icon.xpm\
 about_browser16x16.xpm\
 newFrame16x16.xpm closeFrame16x16.xpm\
 copyFrame16x16.xpm saveImage16x16.xpm\
 about_browser16x16.png\
 newFrame16x16.png closeFrame16x16.png\
 copyFrame16x16.png saveImage16x16.png\
 quickplot.dev mingw.mak mingw_config.h\
 $(html_DATA)


SUFFIXES = .png .xpm .html .html.in _html.cpp 

.png.xpm:
	convert $< $@

.html.in.html:
	./mkhtml $@

.html_html.cpp:
	cat $< | ./html2CString $@

.PHONY: MAKE_RELEASE_DATE homepage


$(nodist_html_DATA): mkhtml CONFIG RELEASE_DATE


File_readSndInt.cpp: File_readSndShort.cpp
	rm -f File_readSndInt.cpp
	echo "// File_readSndInt.cpp  Generated from $(MAKE)\
 and File_readSndShort.cpp" >> File_readSndInt.cpp
	echo "#define TYPE_INT" >> File_readSndInt.cpp
	cat File_readSndShort.cpp >> File_readSndInt.cpp

File_readSndFloat.cpp: File_readSndShort.cpp
	rm -f File_readSndFloat.cpp
	echo "// File_readSndInt.cpp  Generated from $(MAKE)\
 and File_readSndShort.cpp" >> File_readSndFloat.cpp
	echo "#define TYPE_FLOAT" >> File_readSndFloat.cpp
	cat File_readSndShort.cpp >> File_readSndFloat.cpp

File_readSndDouble.cpp: File_readSndShort.cpp
	rm -f File_readSndDouble.cpp
	echo "// File_readSndDouble.cpp  Generated from $(MAKE)\
 and File_readSndShort.cpp" >> File_readSndDouble.cpp
	echo "#define TYPE_DOUBLE" >> File_readSndDouble.cpp
	cat File_readSndShort.cpp >> File_readSndDouble.cpp


configure.ac: mkconfigure_ac CONFIG
	./mkconfigure_ac

# ./mkMakefile_am finds all the *.cc *.h quickplot source files.
Makefile.am: mkMakefile_am Makefile.am.in
	./mkMakefile_am

homepage: $(homepagefiles) dist
	tar -cjf quickplot_homepage-${VERSION}.tar.bz2 $(homepagefiles)
	md5sum quickplot-${VERSION}.tar.bz2 quickplot-${VERSION}.tar.bz2.md5
	md5sum quickplot-${VERSION}.tar.gz quickplot-${VERSION}.tar.gz.md5


dist: MAKE_RELEASE_DATE


MAKE_RELEASE_DATE:
	./mkRELEASE_DATE

mingw_config.h: config.h
	cp $^ $@

